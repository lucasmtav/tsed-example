{"version":3,"file":"getPropertiesStores.js","sourceRoot":"","sources":["../../src/utils/getPropertiesStores.ts"],"names":[],"mappings":";;;AAEA,sDAAiD;AACjD,6DAAwD;AACxD,6DAAwD;AAExD;;;GAGG;AACH,SAAgB,mBAAmB,CACjC,MAAuB;IAEvB,MAAM,KAAK,GAAQ,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,uCAAkB,CAAC,MAAM,CAAC,CAAC;IAExE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;QACtB,MAAM,MAAM,GAAG,uCAAkB,CAAC,KAAK,CAAC,CAAC;QACzC,KAAK,CAAC,WAAW,GAAG,IAAI,GAAG,EAAE,CAAC;QAE9B,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,EAAE,EAAE;YAC9B,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;gBAC1C,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE;oBACjD,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;iBACzD;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;KACJ;IAED,OAAO,KAAK,CAAC,WAAW,CAAC;AAC3B,CAAC;AAnBD,kDAmBC;AASD,SAAgB,aAAa,CAA8C,MAAuB,EAAE,UAAgC,EAAE;IACpI,MAAM,MAAM,GAAG,mBAAmB,CAAI,MAAM,CAAC,CAAC;IAC9C,MAAM,GAAG,GAAqC,IAAI,GAAG,EAAE,CAAC;IAExD,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE;QAC5B,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE;YAC7B,IAAI,yBAAW,CAAC,KAAK,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE;gBAC1C,OAAO;aACR;SACF;QAED,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC;IAEH,OAAO,GAAG,CAAC;AACb,CAAC;AAfD,sCAeC","sourcesContent":["import {Type} from \"@tsed/core\";\nimport {JsonEntityStore} from \"../domain/JsonEntityStore\";\nimport {alterIgnore} from \"../hooks/alterIgnore\";\nimport {getInheritedStores} from \"./getInheritedStores\";\nimport {getJsonEntityStore} from \"./getJsonEntityStore\";\n\n/**\n * Return the list of properties including properties from inherited classes\n * @param target\n */\nexport function getPropertiesStores<T extends JsonEntityStore = JsonEntityStore>(\n  target: Type<any> | any\n): Map<string | symbol | number, T> {\n  const store: any = target.isStore ? target : getJsonEntityStore(target);\n\n  if (!store.$properties) {\n    const stores = getInheritedStores(store);\n    store.$properties = new Map();\n\n    stores.forEach((currentStore) => {\n      currentStore.children.forEach((propStore) => {\n        if (!store.$properties.has(propStore.propertyKey)) {\n          store.$properties.set(propStore.propertyKey, propStore);\n        }\n      });\n    });\n  }\n\n  return store.$properties;\n}\n\nexport interface GetPropertiesOptions {\n  withIgnoredProps?: boolean;\n  groups?: string[] | false;\n\n  [type: string]: any;\n}\n\nexport function getProperties<T extends JsonEntityStore = JsonEntityStore>(target: Type<any> | any, options: GetPropertiesOptions = {}) {\n  const stores = getPropertiesStores<T>(target);\n  const map: Map<string | symbol | number, T> = new Map();\n\n  stores.forEach((store, key) => {\n    if (!options.withIgnoredProps) {\n      if (alterIgnore(store.itemSchema, options)) {\n        return;\n      }\n    }\n\n    map.set(key, store);\n  });\n\n  return map;\n}\n"]}