"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getRequiredProperties = void 0;
const core_1 = require("@tsed/core");
/**
 * @ignore
 */
function getRequiredProperties(obj, schema, useAlias) {
    let required = obj.required || [];
    required = [...required, ...schema.$required];
    if (schema.get("properties")) {
        required = Object.entries(schema.get("properties")).reduce((required, [key, prop]) => {
            if (prop && prop.$selfRequired !== undefined) {
                return prop.$selfRequired ? required.concat(key) : required.filter(key);
            }
            return required;
        }, required);
    }
    const props = Object.keys(obj.properties || {});
    required = core_1.uniq(required)
        .map((key) => (useAlias ? schema.alias.get(key) || key : key))
        .filter((key) => {
        return props.includes(key);
    });
    if (required.length) {
        return {
            ...obj,
            required
        };
    }
    return obj;
}
exports.getRequiredProperties = getRequiredProperties;
//# sourceMappingURL=getRequiredProperties.js.map